language: node_js
node_js:
  - 'node'
cache: npm

jobs:
  include:
    - stage: install
      script: npm install
    - stage: coverage
      script:
        - npm run test:unit:coverage
        - npm run send-coverage
    - stage: version
      before_script:
        - chmod +x .travis/validate-version.js
      script:
        - node .travis/validate-version.js

stages:
  - name: install
    if: (type = pull_request)
  - name: coverage
    if: (type = pull_request)
  - name: version
    if: (type = pull_request AND branch = master) OR (branch = master)
